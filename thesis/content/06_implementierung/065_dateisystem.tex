\section{Dateisystem}\label{section:prototypische-implementierung:dateisystem}

% \begin{note}
%     \textbf{Notizen:}
%     \begin{itemize}
%         \item Beschreibung des Projektbasierten Dateisystems
%         \item Erwähnung der verwendeten VSCode APIs
%               \begin{itemize}
%                   \item FileSystemProvider
%                   \item FileSearchProvider (proposed API)
%                   \item TextSeachProvider (proposed API)
%                   \item TreeDataProvider
%               \end{itemize}
%         \item Beschreibung der Anbindung weiterer Dateisysteme
%               \begin{itemize}
%                   \item Indexed Database
%                   \item In-Memory
%               \end{itemize}
%         \item Beschreibung der Probleme während der Implementierung
%               \begin{itemize}
%                   \item Neuladen von VSCode bei Ordnerwechsel
%                   \item Copy, Cut und Paste Probleme wegen Umschreiben der Pfade
%                   \item
%               \end{itemize}
%         \item Beschreibung der Implementierung der Kollaboration
%         \item Ggf. Beschreibung der Benutzerinterfaces + Screenshots
%         \item (Weitere Beschreibung der CrossLab-Services?)
%     \end{itemize}
% \end{note}

Um die in \autoref{section:konzeption:dateisystem} beschriebenen Konzepte für die Bereitstellung und Nutzung von Dateisystemen umzusetzen wurde der Filesystem Service sowie eine entsprechende Erweiterung für die IDE entwickelt.

Die Erweiterung der IDE ist für die Bereitstellung des integrierten Dateisystems und die Ermöglichung des kollaborativen Arbeitens an Programmen verwantwortlich. Für das integrierte Dateisystem wurde ein projektbasierter Ansatz gewählt. Dabei besitzen Nutzer mehrere verschiedene \textit{Projektordner}, deren direkte Unterordner als \textit{Projekte} bezeichnet werden. In der aktuellen Implementierung gibt es standardmäßig den Projektordner \texttt{/projects}. Die Projektordner sowie die enthaltenen Projekte werden dem Nutzer über ein entsprechendes Benutzerinterface angezeigt. Über dieses kann der Nutzer Projekte erstellen, öffnen, umbenennen und löschen. Für die Einbindung des Dateisystems wurde das Interface \texttt{FileSystemProvider} der VSCode Extension API implementiert. Für die Bereitstellung der Dateisystem-Funktionen können unterschiedliche \textit{Subprovider} verwendet werden. In der aktuellen Implementierung stehen dabei Subprovider für In-Memory, die Indexed Database sowie den Filesystem Service zur Verfügung. Dabei wird standardmäßig der In-Memory Subprovider verwendet und der Indexed Database Subprovider für die persistente Speicherung der Projekte im Pfad \texttt{/projects}. Allerdings können der standardmäßig verwendete Subprovider sowie die Subprovider für bestimmte Pfade angepasst werden und es können neue Subprovider hinzugefügt werden. Weiterhin wurden auch die Interfaces \texttt{FileSearchProvider} und \texttt{TextSeachProvider} der VSCode Extension API implementiert, um es Nutzern zu ermöglichen nach Dateien und Texten innerhalb des aktuellen Projekts zu suchen. Für das Benutzerinterface wurde eine \texttt{TreeView} verwendet, deren Daten über einen entsprechenden \texttt{TreeDataProvider} bereitgestellt werden.

Bei dem Öffnen eines neuen Ordners wird VSCode standardmäßig neugeladen. Dadurch werden auch alle Erweiterungen beendet und neugestartet, was dazu führt, dass das laufende Experiment beendet wird. Um dies zu vermeiden muss der Wechsel von Projekten über einen anderen Mechanismus geschehen. Dazu wurde zunächst ein Pfad festgelegt, welcher standardmäßig von der IDE geöffnet wird. Im Falle der prototypischen Implementierung wurde der Pfad \texttt{/workspace} ausgewählt. Dieser Pfad nutzt standardmäßig einen In-Memory Subprovider. Sollte der Nutzer nun ein Projekt öffnen wird von diesem Moment an der Pfad \texttt{/workspace} in allen URLs durch den Pfad des geöffneten Projektes ersetzt. Dadurch wird kein Neuladen der IDE ausgelöst und Nutzer können zwischen ihren Projekten wechseln. Das Umschreiben der Pfade führt allerdings zu Problemen beim Kopieren, Ausschneiden und Einfügen von Ordnern und Dateien. Daher müssen die entsprechenden Kommandos überschrieben werden um die erwartete Funktionalität zu gewährleisten.

Um das Teilen von Projekten sowie das gleichzeitige Bearbeiten dieser zwischen Nutzern innerhalb eines Experiments zu ermöglichen wurde eine entsprechende Komponente implementiert. Diese nutzt den \texttt{FileSystemProvider} sowie den von der Kollaborationserweiterung bereitgestellten Prosumer. Zu Beginn wird kein Projekt geteilt. Sobald ein Nutzer ein Projekt teilt wird es zu dem geteilten Objekt hinzugefügt. Weiterhin werden auch Funktionen registriert, die auf Änderungen innerhalb des Projekts reagieren. Andere Nutzer die an der Kollaboration teilnehmen können dann das geteilte Projekt über das bereitgestellte Benutzerinterface aufrufen. Alle Änderungen an Dateien und Ordnern werden zwischen den Nutzern synchronisiert. Weiterhin wird die aktuelle Position eines Nutzers innerhalb einer Datei über dessen Zustandsinformationen geteilt. Diese Position wird dann bei anderen Nutzern innerhalb der selben Datei markiert. Wenn der Besitzer des Projekts das Teilen beendet wird das Projekt für alle anderen Nutzer geschlossen. Geteilte Projekte besitzen Pfade der Form \texttt{/shared/\{\{user\_id\}\}/\{\{project\_name\}\}}, wobei der Pfad \texttt{/shared} ein In-Memory Dateisystem verwendet. Die Projektordner \texttt{/shared/\{\{user\_id\}\}} werden automatisch erstellt, wenn ein Nutzer dem entsprechenden Raum beitritt.

Der betrachteten Experimentkonfiguration werden keine neuen Laborgeräte hinzugefügt. Die IDEs werden um einen Filesystem Service Consumer erweitert, der die Anbindung von weiteren Dateisystemen ermöglicht.